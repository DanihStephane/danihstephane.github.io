document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add("loading-active");let e=document.getElementById("progress-percentage"),t=document.getElementById("progressBar"),l=document.getElementById("progressParticles"),n=document.getElementById("preloader"),s=document.getElementById("mosaicGrid");d();let i=0,a=o(),r=0;function o(){let e=document.querySelectorAll("img").length,t=document.querySelectorAll("script").length,l=document.querySelectorAll('link[rel="stylesheet"]').length;return e+t+l+10}function d(){let e=window.innerWidth<=768,t=e?8:10,l=t*t;s.innerHTML="";let n=[{name:"code-block",text:"{...}"},{name:"terminal",text:"$_>"},{name:"tag",text:"</>"},{name:"circuit",text:""},{name:"js",text:"JS"},{name:"data",text:"01"}];for(let i=0;i<l;i++){let a=document.createElement("div"),r=n[Math.floor(Math.random()*n.length)];if(a.className=`mosaic-cell ${r.name}`,a.dataset.index=i,r.text){let o=document.createElement("span");o.textContent=r.text,a.appendChild(o)}let d=Math.floor(360*Math.random());a.style.transform=`rotate(${d}deg)`,s.appendChild(a)}}function c(){l.innerHTML="";for(let e=0;e<15;e++){let t=document.createElement("div");t.className="progress-particle";let n=100*Math.random();t.style.left=`${n}%`;let s=2*Math.random();t.style.animationDelay=`${s}s`;let i=3*Math.random()+1;t.style.width=`${i}px`,t.style.height=`${i}px`,l.appendChild(t)}}function $(e){let t=document.querySelectorAll(".mosaic-cell"),l=t.length,n=Math.floor(e/100*l),s=y(l);for(let i=0;i<n;i++)if(i<s.length){let a=t[s[i]];a.classList.contains("active")||(a.classList.add("active"),Math.random()>.7&&a.classList.add("pulse"),Math.random()>.8&&a.classList.add("glow"),setTimeout(()=>{a.style.transition="all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)"},15*i))}e>30&&u(t,n,s)}function y(e){let t=Math.sqrt(e),l=[],n=Math.floor(t/2),s=[];for(let i=0;i<t;i++)for(let a=0;a<t;a++){let r=i*t+a,o=Math.abs(a-n),d=Math.abs(i-n),c=Math.sqrt(o*o+d*d);s.push({index:r,distance:c})}for(let $ of(s.sort((e,t)=>e.distance-t.distance),s))l.push($.index);return l}function u(e,t,l){let n=document.querySelectorAll(".cell-connection");n.forEach(e=>e.remove());for(let i=0;i<t&&i<l.length;i++){let a=e[l[i]];if(!a.classList.contains("active"))continue;let r=a.getBoundingClientRect(),o=r.left+r.width/2,d=r.top+r.height/2;for(let c=i+1;c<t&&c<l.length;c++){let $=e[l[c]];if(!$.classList.contains("active"))continue;let y=$.getBoundingClientRect(),u=y.left+y.width/2,f=y.top+y.height/2,g=u-o,h=f-d,m=Math.sqrt(g*g+h*h);if(m>50&&m<150){let p=1-(m-50)/100,_="http://www.w3.org/2000/svg",v=document.createElementNS(_,"svg");v.setAttribute("class","cell-connection"),v.style.position="absolute",v.style.top="0",v.style.left="0",v.style.width="100%",v.style.height="100%",v.style.pointerEvents="none",v.style.zIndex="1";let L=document.createElementNS(_,"line");L.setAttribute("x1",o),L.setAttribute("y1",d),L.setAttribute("x2",u),L.setAttribute("y2",f),L.setAttribute("stroke",`rgba(0, 200, 255, ${.5*p})`),L.setAttribute("stroke-width","1"),v.appendChild(L),s.appendChild(v)}}}}function f(e){t.style.width=`${e}%`,e%25==0&&e>0&&(t.classList.add("pulse-effect"),setTimeout(()=>{t.classList.remove("pulse-effect")},700))}function g(){let e=setInterval(()=>{r<90?h(r+=(90-r)*.1):clearInterval(e)},200)}function h(t){let l=Math.round(t);e.textContent=`${l}%`,f(l),$(l)}c(),window.addEventListener("load",()=>{h(r=100),setTimeout(()=>{n.classList.add("hidden"),document.body.classList.remove("loading-active"),setTimeout(()=>{n.style.display="none",document.querySelector(".header").style.opacity="1",document.querySelector(".header").style.pointerEvents="auto"},500)},800)}),g(),document.addEventListener("readystatechange",()=>{if("interactive"===document.readyState||"complete"===document.readyState){i++;let e=i/a*100;e>r&&h(r=e)}}),window.addEventListener("resize",()=>{d(),$(r),c()})});